webpackJsonp([11],{"/rEA":function(e,t,n){"use strict";(function(e){function i(e,t,n){this.name="ApiError",this.message=e||"Default Message",this.errorType=t||g.Default,this.innerError=n,this.stack=(new Error).stack}var a=n("//Fk"),r=n.n(a),o=n("mvHQ"),l=n.n(o),s=n("OvRC"),u=n.n(s),c=n("mtWM"),d=n.n(c),f=n("mw3O"),p=n.n(f),h=n("bzuE"),g={Default:"default",Sysetem:"sysetem"};(i.prototype=u()(Error.prototype)).constructor=i;var m=d.a.create({baseURL:h.a,timeout:2e4,responseType:"json",withCredentials:!0});m.interceptors.request.use(function(e){return"post"===e.method||"put"===e.method||"patch"===e.method?(e.headers={"Content-Type":"application/json charset=utf-8"},e.data=l()(e.data)):"delete"!==e.method&&"get"!==e.method&&"head"!==e.method||(e.paramsSerializer=function(e){return p.a.stringify(e,{arrayFormat:"indices"})}),e},function(e){return e}),m.interceptors.response.use(function(t){if(-1===t.headers["content-type"].indexOf("json"))return t;var n=void 0;if("arraybuffer"===t.request.responseType&&"[object ArrayBuffer]"===t.data.toString()){var a=e.from(t.data).toString("utf8");console.log(a),n=JSON.parse(a)}else n=t.data;if(n&&n.url)top.location=n.url;else if(n&&200!==n.code)return console.log(n),r.a.reject(new i(n.message));return t},function(e){return r.a.reject(new i(e.message,g.Sysetem,e))}),t.a={install:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.httpClient=m,e.prototype.$httpClient=m}}}).call(t,n("EuP9").Buffer)},"6E37":function(e,t,n){"use strict";var i=n("BO1k"),a=n.n(i),r=n("VsUZ"),o=n("M4fF"),l=n.n(o);t.a={data:function(){return{isLoading:!1,page:{list:null,totalItemCount:null,totalPageCount:null},searchCriteriaForm:{keyword:null,toUserID:null,creationDate:null,creationDateBegin:null,creationDateEnd:null,isReaded:!1},isReadedNumber:1,pagingInfoForm:{pageNumber:1,pageSize:20,isExcludeMetaData:!1,sortInfo:{sort:"NotificationID",sortDir:"DESC"}},selection:null,deleteOneActive:null,deleteOneConfirmDialogVisible:!1,deleteMultipleConfirmDialogVisible:!1,readMultipleConfirmDialogVisible:!1,editActive:null,mainFormDialogVisible:!1,mainForm:{notificationID:null,title:null,message:null},mainFormRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:100,message:"最多支持100个字符",trigger:"blur"}],message:[{required:!0,message:"请输入消息",trigger:"blur"},{max:1e3,message:"最多支持1000个字符",trigger:"blur"}]}}},mounted:function(){this.getPage()},computed:{emptyText:function(){return this.isLoading?"加载中...":"暂无数据"}},watch:{},methods:{getPage:function(){var e=this;this.isLoading=!0;var t=l.a.extend({},this.pagingInfoForm,this.searchCriteriaForm);r.a.getNotifications(t).then(function(t){e.isLoading=!1,e.page=t.data.page},function(t){e.isLoading=!1,e.showErrorMessage(t.message)})},handlePaginationSizeChange:function(e){this.pagingInfoForm.pageSize=e,this.pagingInfoForm.pageNumber=1,this.getPage()},handlePaginationCurrentChange:function(e){this.pagingInfoForm.pageNumber=e,this.getPage()},handleSearchAll:function(){this.pagingInfoForm.pageNumber=1,this.searchCriteriaForm.keyword=null,this.searchCriteriaForm.creationDateBegin=null,this.searchCriteriaForm.creationDateEnd=null,this.getPage()},handleSearch:function(){this.pagingInfoForm.pageNumber=1,this.searchCriteriaForm.creationDate&&2===this.searchCriteriaForm.creationDate.length&&(this.searchCriteriaForm.creationDateBegin=this.searchCriteriaForm.creationDate[0],this.searchCriteriaForm.creationDateEnd=this.searchCriteriaForm.creationDate[1]),this.getPage()},handleIsReadChange:function(e){this.searchCriteriaForm.isReaded=e?2===e:null,this.handleSearch()},handleDeleteOne:function(e){this.deleteOneActive=e,this.deleteOneConfirmDialogVisible=!0},handleDeleteOneSure:function(e){this.deleteOneConfirmDialogVisible=!1,e?this.deleteOne():this.deleteOneActive=null},handleDeleteMultiple:function(){this.selection&&0!==this.selection.length?this.deleteMultipleConfirmDialogVisible=!0:this.$message({message:"请选择要删除的记录",type:"warning"})},handleDeleteMultipleSure:function(e){this.deleteMultipleConfirmDialogVisible=!1,e&&this.deleteMultiple()},deleteOne:function(){this.deleteOneActive&&this.delete([this.deleteOneActive.notificationID])},deleteMultiple:function(){this.delete(this.selection.map(function(e){return e.notificationID}))},delete:function(e){var t=this;if(e&&0!==e.length){var n={notificationIDs:e};this.isLoading=!0,r.a.deleteNotifications(n).then(function(e){t.isLoading=!1,t.deleteOneActive=null,t.getPage()},function(e){t.isLoading=!1,t.showErrorMessage(e.message)})}},handleReadOne:function(e){this.read([e.notificationID])},handleReadMultiple:function(){this.selection&&0!==this.selection.length?this.readMultipleConfirmDialogVisible=!0:this.$message({message:"请选择要设置为已读的记录",type:"warning"})},handleReadMultipleSure:function(e){this.readMultipleConfirmDialogVisible=!1,e&&this.readMultiple()},readMultiple:function(){this.read(this.selection.map(function(e){return e.notificationID}))},read:function(e){var t=this;if(e&&0!==e.length){var n={notificationIDs:e};r.a.readNotifications(n).then(function(n){var i=!0,r=!1,o=void 0;try{for(var l,s=a()(t.page.list);!(i=(l=s.next()).done);i=!0){var u=l.value,c=!0,d=!1,f=void 0;try{for(var p,h=a()(e);!(c=(p=h.next()).done);c=!0){var g=p.value;u.notificationID!==g||(u.readTime=new Date)}}catch(e){d=!0,f=e}finally{try{!c&&h.return&&h.return()}finally{if(d)throw f}}}}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}},function(e){t.showErrorMessage(e.message)})}},resetForm:function(e){this.$refs[e].resetFields()},clearValidate:function(e){this.$refs[e].clearValidate()},showErrorMessage:function(e){this.$message({message:e,type:"error"})},handleSortChange:function(e){this.pagingInfoForm.sortInfo.sort=e.prop,this.pagingInfoForm.sortInfo.sortDir="descending"===e.order?"DESC":"ASC",this.pagingInfoForm.pageNumber=1,this.getPage()},handleSelectionChange:function(e){this.selection=e},handleRowClick:function(e,t,n){"el-table_1_column_2"!==n.id&&this.$refs.mainTable.toggleRowExpansion(e)},handleExpandChange:function(e,t){console.log("handleExpandChange",e,t),e.readTime||this.handleReadOne(e)}}}},"8GiD":function(e,t,n){"use strict";var i=n("6E37"),a=n("d72m"),r=function(e){n("fZKa")},o=n("VU/8")(i.a,a.a,!1,r,null,null);t.a=o.exports},VsUZ:function(e,t,n){"use strict";var i=n("7+uW");t.a={login:function(e){return i.default.httpClient.post("/admin/login",e)},logout:function(){return i.default.httpClient.post("/admin/logout")},getProfile:function(){return i.default.httpClient.get("/admin/getProfile")},changeProfile:function(e){return i.default.httpClient.post("/admin/changeProfile",e)},changePassword:function(e){return i.default.httpClient.post("/admin/changePassword",e)},getMenus:function(){return i.default.httpClient.get("/admin/getMenus")},getServerInfo:function(){return i.default.httpClient.get("/admin/getServerinfo")},getSiteConfig:function(){return i.default.httpClient.get("/admin/getSiteconfig")},editSiteConfig:function(e){return i.default.httpClient.post("/admin/editSiteconfig",e)},getBulletin:function(){return i.default.httpClient.get("/admin/getBulletin")},editBulletin:function(e){return i.default.httpClient.post("/admin/editBulletin",e)},getPermissions:function(){return i.default.httpClient.get("/admin/getPermissions")},getModuleConfig:function(){return i.default.httpClient.get("/admin/getModuleConfig")},extractModulePermissions:function(){return i.default.httpClient.get("/admin/extractModulePermissions")},clearModulePermissions:function(){return i.default.httpClient.get("/admin/clearModulePermissions")},getRoles:function(){return i.default.httpClient.get("/admin/getRoles")},addRole:function(e){return i.default.httpClient.post("/admin/addRole",e)},editRole:function(e){return i.default.httpClient.post("/admin/editRole",e)},removeRole:function(e){return i.default.httpClient.post("/admin/removeRole",e)},moveRole:function(e){return i.default.httpClient.post("/admin/moveRole",e)},saveRoleName:function(e){return i.default.httpClient.post("/admin/saveRoleName",e)},getGroupTree:function(){return i.default.httpClient.get("/admin/getGroupTree")},addGroup:function(e){return i.default.httpClient.post("/admin/addGroup",e)},editGroup:function(e){return i.default.httpClient.post("/admin/editGroup",e)},removeGroup:function(e){return i.default.httpClient.post("/admin/removeGroup",e)},moveGroup:function(e){return i.default.httpClient.post("/admin/moveGroup",e)},getUsers:function(e){return i.default.httpClient.post("/admin/getUsers",e)},addUser:function(e){return i.default.httpClient.post("/admin/addUser",e)},editUser:function(e){return i.default.httpClient.post("/admin/editUser",e)},removeUser:function(e){return i.default.httpClient.post("/admin/removeUser",e)},getUserStatus:function(){return i.default.httpClient.get("/admin/getUserStatus")},getNotificationsForManager:function(e){return i.default.httpClient.post("/admin/getNotificationsForManager",e)},addNotification:function(e){return i.default.httpClient.post("/admin/addNotification",e)},editNotification:function(e){return i.default.httpClient.post("/admin/editNotification",e)},removeNotification:function(e){return i.default.httpClient.post("/admin/removeNotification",e)},getNotifications:function(e){return i.default.httpClient.post("/admin/getNotifications",e)},readNotifications:function(e){return i.default.httpClient.post("/admin/readNotifications",e)},deleteNotifications:function(e){return i.default.httpClient.post("/admin/deleteNotifications",e)},getNewestNotification:function(e){return i.default.httpClient.post("/admin/getNewestNotification",e)},getGroups:function(){return i.default.httpClient.get("/admin/getGroups")},getRoleBases:function(){return i.default.httpClient.get("/admin/getRoleBases")},getPermissionTree:function(){return i.default.httpClient.get("/admin/getPermissionTree")},directlyCall:function(e){return i.default.httpClient.get(e)},download:function(e,t){return i.default.httpClient.post(e,t,{responseType:"arraybuffer"})}}},bzuE:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return r});var i="/manager/api",a="",r=""},d72m:function(e,t,n){"use strict";var i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}]},[n("el-header",{staticClass:"header"},[n("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[n("el-breadcrumb-item",[e._v("通知中心")])],1)],1),e._v(" "),n("el-main",{staticClass:"main"},[n("el-form",{ref:"searchCriteriaForm",staticClass:"searchCriteriaForm",attrs:{model:e.searchCriteriaForm,inline:"",size:"mini"}},[n("el-row",[n("el-form-item",[n("el-radio-group",{on:{change:e.handleIsReadChange},model:{value:e.isReadedNumber,callback:function(t){e.isReadedNumber=t},expression:"isReadedNumber"}},[n("el-radio-button",{attrs:{label:1}},[e._v("未读")]),e._v(" "),n("el-radio-button",{attrs:{label:2}},[e._v("已读")]),e._v(" "),n("el-radio-button",[e._v("全部")])],1)],1),e._v(" "),n("el-form-item",[n("el-input",{staticClass:"filterText",attrs:{placeholder:"关键字(标题)",clearable:""},model:{value:e.searchCriteriaForm.keyword,callback:function(t){e.$set(e.searchCriteriaForm,"keyword",t)},expression:"searchCriteriaForm.keyword"}})],1),e._v(" "),n("el-form-item",[n("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"创建日期开始","end-placeholder":"创建日期结束"},model:{value:e.searchCriteriaForm.creationDate,callback:function(t){e.$set(e.searchCriteriaForm,"creationDate",t)},expression:"searchCriteriaForm.creationDate"}})],1),e._v(" "),n("el-form-item",[n("el-button-group",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.handleSearch()}}},[e._v("搜索")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.handleSearchAll()}}},[e._v("全部")])],1)],1)],1),e._v(" "),n("el-row",[n("el-form-item",[n("el-button-group",[n("el-button",{attrs:{plain:"",icon:"el-icon-view"},on:{click:function(t){e.handleReadMultiple()}}},[e._v("设置已读")]),e._v(" "),n("el-button",{attrs:{plain:"",icon:"el-icon-remove-outline"},on:{click:function(t){e.handleDeleteMultiple()}}},[e._v("删除通知")])],1)],1)],1)],1),e._v(" "),n("el-row",[n("el-table",{ref:"mainTable",staticStyle:{width:"100%"},attrs:{data:e.page.list,size:"small","empty-text":e.emptyText},on:{"selection-change":e.handleSelectionChange,"expand-change":e.handleExpandChange,"row-click":e.handleRowClick,"sort-change":e.handleSortChange}},[n("el-table-column",{attrs:{type:"selection",width:"56"}}),e._v(" "),n("el-table-column",{attrs:{type:"expand",label:"查看"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{domProps:{innerHTML:e._s(t.row.message)}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"notificationID",label:"#",width:"60",sortable:"custom"}}),e._v(" "),n("el-table-column",{attrs:{prop:"title",label:"标题"}}),e._v(" "),n("el-table-column",{attrs:{label:"已读",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.readTime?"√":""))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"来自",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.fromUser?t.row.fromUser.displayName:"系统"))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"送至",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.toUser?t.row.toUser.displayName:"全部"))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"creationDate",label:"创建时间",width:"160"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"42"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(n){e.handleDeleteOne(t.row)}}})]}}])})],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"提示",visible:e.deleteOneConfirmDialogVisible,width:"320px",center:""},on:{"update:visible":function(t){e.deleteOneConfirmDialogVisible=t}}},[n("span",[e._v("确定要删除该通知吗？")]),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.handleDeleteOneSure(!1)}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleDeleteOneSure(!0)}}},[e._v("确 定")])],1)]),e._v(" "),n("el-dialog",{attrs:{title:"提示",visible:e.deleteMultipleConfirmDialogVisible,width:"320px",center:""},on:{"update:visible":function(t){e.deleteMultipleConfirmDialogVisible=t}}},[n("span",[e._v("确定要将选择的通知删除吗？")]),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.handleDeleteMultipleSure(!1)}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleDeleteMultipleSure(!0)}}},[e._v("确 定")])],1)]),e._v(" "),n("el-dialog",{attrs:{title:"提示",visible:e.readMultipleConfirmDialogVisible,width:"320px",center:""},on:{"update:visible":function(t){e.readMultipleConfirmDialogVisible=t}}},[n("span",[e._v("确定要将选择的通知设置为已读吗？")]),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.handleReadMultipleSure(!1)}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleReadMultipleSure(!0)}}},[e._v("确 定")])],1)])],1),e._v(" "),n("el-footer",{staticClass:"footer"},[e.page.totalItemCount?n("el-pagination",{attrs:{"current-page":e.pagingInfoForm.pageNumber,"page-sizes":[20,50,100,200,400],"page-size":e.pagingInfoForm.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalItemCount},on:{"size-change":e.handlePaginationSizeChange,"current-change":e.handlePaginationCurrentChange}}):e._e()],1)],1)},staticRenderFns:[]};t.a=i},fZKa:function(e,t){},mQcG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("tvR6"),a=(n.n(i),n("qBF2")),r=n.n(a),o=n("7+uW"),l=n("uN2V"),s=(n.n(l),n("8GiD")),u=n("/rEA");o.default.config.productionTip=!1,o.default.use(r.a),o.default.use(u.a),new o.default({el:"#app",render:function(e){return e(s.a)}})},tvR6:function(e,t){},uN2V:function(e,t){}},["mQcG"]);
//# sourceMappingURL=notification.js.map