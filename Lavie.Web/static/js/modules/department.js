webpackJsonp([6],{"/rEA":function(e,t,i){"use strict";(function(e){function a(e,t,i){this.name="ApiError",this.message=e||"Default Message",this.errorType=t||p.Default,this.innerError=i,this.stack=(new Error).stack}var o=i("rVsN"),n=i.n(o),r=i("3cXf"),l=i.n(r),s=i("IYkF"),u=i.n(s),d=i("2sCs"),f=i.n(d),m=i("DEjr"),c=i.n(m),h=i("bzuE"),p={Default:"default",Sysetem:"sysetem"};a.prototype=u()(Error.prototype),a.prototype.constructor=a;var v=f.a.create({baseURL:h.a,timeout:2e4,responseType:"json",withCredentials:!0});v.interceptors.request.use(function(e){return"post"===e.method||"put"===e.method||"patch"===e.method?(e.headers={"Content-Type":"application/json charset=utf-8"},e.data=l()(e.data)):"delete"!==e.method&&"get"!==e.method&&"head"!==e.method||(e.paramsSerializer=function(e){return c.a.stringify(e,{arrayFormat:"indices"})}),e},function(e){return e}),v.interceptors.response.use(function(t){if(-1===t.headers["content-type"].indexOf("json"))return t;var i=void 0;if("arraybuffer"===t.request.responseType&&"[object ArrayBuffer]"===t.data.toString()){var o=e.from(t.data).toString("utf8");console.log(o),i=JSON.parse(o)}else i=t.data;if(i&&i.url)top.location=i.url;else if(i&&200!==i.code)return console.log(i),n.a.reject(new a(i.message));return t},function(e){return n.a.reject(new a(e.message,p.Sysetem,e))}),t.a={install:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.httpClient=v,e.prototype.$httpClient=v}}}).call(t,i("7xR8").Buffer)},"2jAk":function(e,t){},"5/xs":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}]},[i("el-header",{staticClass:"header",staticStyle:{background:"#EDF2FC","margin-bottom":"5px"}},[i("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",[e._v("部门管理")])],1)],1),e._v(" "),i("el-main",{staticClass:"main"},[i("el-row",[i("el-input",{staticClass:"filterText",attrs:{placeholder:"输入关键字进行过滤",size:"mini"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.handleAdd()}}},[e._v("添加")])],1),e._v(" "),i("el-row",[i("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.treeDefaultProps,"empty-text":e.emptyText,"node-key":"id","filter-node-method":e.filterNode,"render-content":e.renderContent,"default-expand-all":!0}})],1),e._v(" "),i("el-dialog",{attrs:{visible:e.mainFormDialogVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.mainFormDialogVisible=t}},nativeOn:{submit:function(e){e.preventDefault()}}},[i("span",{attrs:{slot:"title"},slot:"title"},[e._v("\r\n        "+e._s(e.editActive?"编辑":"添加")+"\r\n      ")]),e._v(" "),i("el-form",{ref:"mainForm",attrs:{model:e.mainForm,rules:e.mainFormRules,"label-position":"right","label-width":"100px",size:"small"}},[i("el-tabs",{attrs:{type:"card"},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[i("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[i("el-form-item",{attrs:{label:"所属分组"}},[i("el-cascader",{attrs:{options:e.editParentTreeData,props:e.editParentTreeDefaultProps,clearable:"","change-on-select":""},model:{value:e.mainForm.parentIDPath,callback:function(t){e.$set(e.mainForm,"parentIDPath",t)},expression:"mainForm.parentIDPath"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"用户组名称",prop:"name"}},[i("el-input",{ref:"name",attrs:{"auto-complete":"off",placeholder:"请输入用户组名称"},model:{value:e.mainForm.name,callback:function(t){e.$set(e.mainForm,"name","string"==typeof t?t.trim():t)},expression:"mainForm.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"是否包含用户"}},[i("el-switch",{model:{value:e.mainForm.isIncludeUser,callback:function(t){e.$set(e.mainForm,"isIncludeUser",t)},expression:"mainForm.isIncludeUser"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"是否停用"}},[i("el-switch",{model:{value:e.mainForm.isDisabled,callback:function(t){e.$set(e.mainForm,"isDisabled",t)},expression:"mainForm.isDisabled"}})],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"限制角色",name:"second"}},[i("el-form-item",{attrs:{label:"限制角色"}},[i("el-checkbox-group",{model:{value:e.mainForm.limitRoleIDs,callback:function(t){e.$set(e.mainForm,"limitRoleIDs",t)},expression:"mainForm.limitRoleIDs"}},e._l(e.editRoleListData,function(t){return i("el-checkbox",{key:t.roleID,attrs:{label:t.roleID}},[e._v(e._s(t.name))])}))],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.handleMainFormSure(!1)}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleMainFormSure(!0)}}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"提示",visible:e.removeConfirmDialogVisible,width:"320px",center:""},on:{"update:visible":function(t){e.removeConfirmDialogVisible=t}}},[i("span",[e._v("删除该用户组后，相关的数据也将被删除。"),i("br"),e._v("确定要删除吗？")]),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.handleRemoveSure(!1)}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleRemoveSure(!0)}}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:e.leaveTitle,visible:e.isstationLeaveAuditFlowForm,width:"800px",center:""},on:{"update:visible":function(t){e.isstationLeaveAuditFlowForm=t}}},[i("el-form",{ref:"leavemain",attrs:{model:e.leavemain,rules:e.stationLeaveFormRules,"label-position":"right","label-width":"100px",size:"small"}},[i("el-form-item",{attrs:{label:"发起申请",prop:"auditRoleID"}},[i("el-select",{attrs:{placeholder:"请选择",clearable:!0},model:{value:e.leavemain.domains[0].auditRoleID,callback:function(t){e.$set(e.leavemain.domains[0],"auditRoleID",t)},expression:"leavemain.domains[0].auditRoleID"}},e._l(e.leaveActive.limitRoles,function(e){return i("el-option",{key:e.roleID,attrs:{label:e.name,value:e.roleID}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"申请流程"}},[e._l(e.leavemain.domains,function(t,a){return i("el-form-item",{key:t.index},[i("el-form-item",{staticStyle:{width:"100px",float:"left"}},[i("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"天数"},model:{value:t.auditStaffLevelMaxDays,callback:function(i){e.$set(t,"auditStaffLevelMaxDays",i)},expression:"item.auditStaffLevelMaxDays"}})],1),e._v(" "),i("el-form-item",{staticStyle:{width:"150px",float:"left"},attrs:{label:"天内(含), 由","label-width":"100px"}},[i("el-cascader",{staticStyle:{width:"150px"},attrs:{options:e.dataList,props:e.defaultProps,clearable:"",filterable:"",placeholder:"部门",disabled:0===a,"change-on-select":""},on:{change:function(t){e.handChangeTree(null,null,a)}},model:{value:t.auditGroupIDPath,callback:function(i){e.$set(t,"auditGroupIDPath",i)},expression:"item.auditGroupIDPath"}})],1),e._v(" "),i("el-form-item",{staticStyle:{width:"150px",float:"left","margin-left":"110px"}},[i("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:0===a&&e.stationLeaveAuditFlowForm.requestRoleID?e.leaveName:"职位",disabled:0===a,clearable:!0},model:{value:t.auditRoleID,callback:function(i){e.$set(t,"auditRoleID",i)},expression:"item.auditRoleID"}},e._l(e.limitRoleForm[a],function(e){return i("el-option",{key:e.RoleID,attrs:{label:e.Name,value:e.RoleID}})}))],1),e._v(" "),i("el-form-item",{staticStyle:{width:"20px",float:"left"},attrs:{label:"审批","label-width":"50px"}}),e._v(" "),a>0?i("el-button",{staticStyle:{"font-size":"15px",position:"absolute",top:"0",right:"20px"},attrs:{type:"text",icon:"el-icon-remove-outline"},on:{click:function(i){i.preventDefault(),e.removeLeave(t)}}},[e._v("删除")]):e._e()],1)}),e._v(" "),i("el-button",{staticStyle:{"font-size":"15px",position:"absolute",top:"0",right:"20px"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.addLeave}},[e._v("添加")])],2)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.handleLeaveSure(!1)}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleLeaveSure(!0)}}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.moveFormDialogVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.moveFormDialogVisible=t}},nativeOn:{submit:function(e){e.preventDefault()}}},[i("span",{attrs:{slot:"title"},slot:"title"},[e._v("\r\n        移动节点: "+e._s(e.moveActive?e.moveActive.name:null)+"\r\n      ")]),e._v(" "),i("el-form",{ref:"moveForm",attrs:{model:e.moveForm,rules:e.moveFormRules,"label-position":"right","label-width":"100px",size:"small"}},[i("el-form-item",{attrs:{label:"目标节点",prop:"targetIDPath"}},[i("el-cascader",{attrs:{options:e.editParentTreeData,props:e.editParentTreeDefaultProps,clearable:"","change-on-select":""},model:{value:e.moveForm.targetIDPath,callback:function(t){e.$set(e.moveForm,"targetIDPath",t)},expression:"moveForm.targetIDPath"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"位置"}},[[i("el-radio",{attrs:{label:0,border:""},model:{value:e.moveForm.movingLocation,callback:function(t){e.$set(e.moveForm,"movingLocation",t)},expression:"moveForm.movingLocation"}},[e._v("目标之下")]),e._v(" "),i("el-radio",{attrs:{label:1,border:""},model:{value:e.moveForm.movingLocation,callback:function(t){e.$set(e.moveForm,"movingLocation",t)},expression:"moveForm.movingLocation"}},[e._v("目标之上")])]],2),e._v(" "),0===e.moveForm.movingLocation?i("el-form-item",{attrs:{label:"作为子节点"}},[i("el-switch",{model:{value:e.moveForm.isChild,callback:function(t){e.$set(e.moveForm,"isChild",t)},expression:"moveForm.isChild"}})],1):e._e()],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.handleMoveFormSure(!1)}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleMoveFormSure(!0)}}},[e._v("确 定")])],1)],1)],1)],1)},o=[],n={render:a,staticRenderFns:o};t.a=n},"8Som":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Uo1D"),o=(i.n(a),i("Ni1V")),n=i.n(o),r=i("E7jK"),l=i("uN2V"),s=(i.n(l),i("nbfF")),u=i("/rEA");r.default.config.productionTip=!1,r.default.use(n.a),r.default.use(u.a),new r.default({el:"#app",render:function(e){return e(s.a)}})},Uo1D:function(e,t){},VsUZ:function(e,t,i){"use strict";var a=i("E7jK");t.a={login:function(e){return a.default.httpClient.post("/admin/login",e)},getStaffInfoList:function(e){return a.default.httpClient.post("/Staff/GetStaffInfoList",e)},GetStaffBaseList:function(e){return a.default.httpClient.post("/Project/Staff/GetStaffBaseList",e)},GetGroupInfoBaseList:function(){return a.default.httpClient.post("/Project/Staff/HRGetGroupInfoBaseList")},GetStaffInfoList:function(e){return a.default.httpClient.post("/Project/Staff/Add",e)},GetEducationInfoBaseList:function(){return a.default.httpClient.post("/Project/Staff/GetEducationInfoBaseList")},SetEdit:function(e){return a.default.httpClient.post("/Project/Staff/Edit",e)},GetStaffInfo:function(e){return a.default.httpClient.post("/Project/Staff/GetStaffInfo")},GetDictionaryList:function(){return a.default.httpClient.post("/Project/Staff/GetDictionaryList")},getStaffInfoBaseList:function(e){return a.default.httpClient.post("/Project/Staff/GetStaffInfoBaseList",e)},getEntry:function(e){return a.default.httpClient.post("/Project/Staff/Entry",e)},resetEditBank:function(e){return a.default.httpClient.post("/Project/Staff/EditBank",e)},resetEditRecruitChannel:function(e){return a.default.httpClient.post("/Project/Staff/EditRecruitChannel",e)},resetEditInsurance:function(e){return a.default.httpClient.post("/Project/Staff/EditInsurance",e)},resetEditRiderReferrer:function(e){return a.default.httpClient.post("/Project/Staff/EditRiderReferrer",e)},getExitReasonInfoBaseList:function(){return a.default.httpClient.post("/Project/Staff/GetExitReasonInfoBaseList")},getExitUserReason:function(e){return a.default.httpClient.post("/Project/Staff/Exit",e)},getInBlackList:function(e){return a.default.httpClient.post("/Project/Staff/InBlackList",e)},getEditRiderEleID:function(e){return a.default.httpClient.post("/Project/Staff/EditRiderEleID",e)},getchangeRiderJobType:function(e){return a.default.httpClient.post("/Project/Staff/ChangeRiderJobType",e)},getStaffTurnover:function(){return a.default.httpClient.post("/Project/Staff/GetStaffTurnoverTypeInfoBaseList")},getTurnoverList:function(e){return a.default.httpClient.post("/Project/Staff/Turnover",e)},getRequestStationLeave:function(e){return a.default.httpClient.post("/Project/Flow/RequestStationLeave",e)},getStaffLeaveTypeInfoBaseList:function(e){return a.default.httpClient.post("/Project/Staff/GetStaffLeaveTypeInfoBaseList",e)},getStationLeaveList:function(e){return a.default.httpClient.post("/Project/Flow/GetStationLeaveList",e)},getAuditStationLeave:function(e){return a.default.httpClient.post("/Project/Flow/AuditStationLeave",e)},getGroupTree:function(){return a.default.httpClient.get("/Project/Group/GetGroupTree")},addGroup:function(e){return a.default.httpClient.post("/Project/Group/AddGroup",e)},editGroup:function(e){return a.default.httpClient.post("/Project/Group/EditGroup",e)},removeGroup:function(e){return a.default.httpClient.post("/Project/Group/RemoveGroup",e)},moveGroup:function(e){return a.default.httpClient.post("/Project/Group/MoveGroup",e)},getRoleBases:function(){return a.default.httpClient.get("/admin/getRoleBases")},getConfigStaffLeaveAuditFlow:function(e){return a.default.httpClient.post("/Project/Group/ConfigStaffLeaveAuditFlow",e)},importAttendance:function(e){return a.default.httpClient.post("/Project/Report/ImportAttendance",e,{responseType:"arraybuffer",timeout:6e4})},getCitys:function(){return a.default.httpClient.post("/Project/Group/GetCitys")},getRole:function(){return a.default.httpClient.post("/Project/Group/GetRoles")},getStaffStatus:function(){return a.default.httpClient.post("Project/Staff/GetStaffStatus")},calculate:function(e){return a.default.httpClient.post("/Project/Report/Calculate",e,{responseType:"arraybuffer",timeout:6e4})}}},bdjN:function(e,t,i){"use strict";var a=i("HzJ8"),o=i.n(a),n=i("3cXf"),r=i.n(n),l=i("VsUZ"),s=i("dLdd"),u=i.n(s);t.a={data:function(){return{isLoading:!1,activeTabName:"first",treeData:null,treeDefaultProps:{children:"children",value:"id",label:"name"},filterText:null,removeActive:null,removeConfirmDialogVisible:!1,moveActive:null,moveFormDialogVisible:!1,editActive:null,mainFormDialogVisible:!1,mainForm:{groupID:null,name:null,limitRoleIDs:[],parentIDPath:[],parentID:null,isIncludeUser:null,isDisabled:null},moveForm:{sourceID:null,targetIDPath:null,targetID:null,isChild:!1,movingLocation:0},mainFormRules:{name:[{required:!0,message:"请输入用户组名称",trigger:"blur"},{max:50,message:"最多支持50个字符",trigger:"blur"}]},moveFormRules:{targetIDPath:[{required:!0,type:"array",message:"请选择目标节点",trigger:"change"}]},stationLeaveFormRules:{auditRoleID:[{required:!0,message:"发起申请内容不能为空"}]},editRoleListData:null,editParentTreeData:null,editParentTreeDefaultProps:{children:"children",value:"id",label:"name"},isstationLeaveAuditFlowForm:!1,stationLeaveAuditFlowForm:{staffLeaveAuditFlowID:null,requestRoleID:null,auditStaffLevelMaxDays1:null,auditGroupID1:null,auditGroupID1Path:[],auditRoleID1:null,auditStaffLevelMaxDays2:null,auditGroupID2:null,auditGroupID2Path:[],auditRoleID2:null,auditStaffLevelMaxDays3:null,auditGroupID3:null,auditGroupID3Path:[],auditRoleID3:null,auditStaffLevelMaxDays4:null,auditGroupID4:null,auditGroupID4Path:[],auditRoleID4:null},leaveName:"",leaveTitle:"",auditGroupName:"",leaveActive:[],leaveRole:[],limitRoles:[],limitRoleForm:[],tree:[],sourceList:[],dataList:[],valueObject:"",defaultProps:{children:"Children",label:"Name",value:"GroupID"},leavemain:{domains:[{auditStaffLevelMaxDays:"",auditGroupID:"",auditGroupIDPath:[],auditRoleID:""}]}}},mounted:function(){this.getTree(),this.getRoleBases(),this.getGroupInfoBaseList()},computed:{emptyText:function(){return this.isLoading?"加载中...":"暂无数据"}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{getTree:function(){var e=this;this.isLoading=!0,l.a.getGroupTree().then(function(t){e.isLoading=!1,e.treeData=t.data.tree},function(t){e.isLoading=!1,e.showErrorMessage(t.message)})},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},getRoleBases:function(){var e=this;l.a.getRoleBases().then(function(t){e.editRoleListData=t.data.list},function(t){e.showErrorMessage(t.message)})},handleAdd:function(e,t){var i=this;if(console.log("handleAdd",e,t),this.validateBaseData()){var a=[];t&&(a=t.parentIDPath?t.parentIDPath:[],a.push(t.id)),this.activeTabName="first",this.editActive=null,this.generateParentTree(null),this.mainFormDialogVisible=!0,this.mainForm.groupID=null,this.mainForm.name=null,this.mainForm.parentIDPath=a,this.mainForm.parentID=t?t.id:null,this.mainForm.limitRoleIDs=[],this.mainForm.isIncludeUser=!0,this.mainForm.isDisabled=!1,this.$nextTick(function(){i.clearValidate("mainForm")})}},handleEdit:function(e,t){var i=this;console.log("handleEdit",e,t),this.validateBaseData()&&t&&(this.activeTabName="first",this.editActive=t,this.generateParentTree(t),this.mainFormDialogVisible=!0,this.mainForm.groupID=t.id,this.mainForm.name=t.name,this.mainForm.parentIDPath=t.parentIDPath,this.mainForm.parentID=t.id,this.mainForm.limitRoleIDs=t.limitRoles.map(function(e){return e.roleID}),this.mainForm.isIncludeUser=t.isIncludeUser,this.mainForm.isDisabled=t.isDisabled,this.$nextTick(function(){i.clearValidate("mainForm")}))},handleMainFormSure:function(e){console.log("handleMainFormSure",e),e?this.editActive?this.edit():this.add():this.mainFormDialogVisible=!1},handleRemove:function(e,t){this.removeActive=t,this.removeConfirmDialogVisible=!0},handleRemoveSure:function(e){this.removeConfirmDialogVisible=!1,e?this.remove():this.removeActive=null},handleLeave:function(e,t){if(this.leaveActive=t,this.isstationLeaveAuditFlowForm=!0,this.leaveTitle=t.name+" 请假流程设置",this.limitRoleForm=[],this.leavemain.domains=[{auditStaffLevelMaxDays:"",auditGroupID:"",auditGroupIDPath:[],auditRoleID:""}],this.stationLeaveAuditFlowForm.staffLeaveAuditFlowID=t.id,void 0===t.staffLeaveAuditFlow)this.leavemain.domains[0].auditGroupIDPath=[t.id],this.getGroupIDPath(this.treeData,t.id,0),this.handChangeTree(this.leavemain.domains[0].auditGroupIDPath,null,null);else{var i=t.staffLeaveAuditFlow,a={},o=0;for(var n in i)null!==i[n]&&(null===i[n].RoleID&&null===i[n].GroupID||("RequestRoleID"===n&&(this.stationLeaveAuditFlowForm.requestRoleID=i[n].RequestRoleID),"RequestRoleID"!==n&&"StaffLeaveAuditFlowID"!==n&&(o++,a[n]=i[n])));for(var l=0;l<o/3;l++){for(var s=o/3-1,u=0;u<s;u++){this.leavemain.domains.length===u+1&&this.leavemain.domains.push({auditStaffLevelMaxDays:"",auditGroupID:"",auditRoleID:"",auditGroupIDPath:[],key:Date.now()})}for(var d in a){var f="AuditGroupID"+(l+1),m="AuditRoleID"+(l+1),c="AuditStaffLevelMaxDays"+(l+1);d===f&&(this.leavemain.domains[l].auditGroupID=a[d].GroupID,this.getGroupIDPath(this.treeData,a[d].GroupID,l),this.handChangeTree(this.leavemain.domains[l].auditGroupIDPath,l,null)),d===m&&(this.leavemain.domains[l].auditRoleID=a[d].RoleID),d===c&&(this.leavemain.domains[l].auditStaffLevelMaxDays=a[d])}}}console.log("请假部门数据"+r()(this.leavemain.domains))},getGroupIDPath:function(e,t,i){if(e){var a=!0,n=!1,r=void 0;try{for(var l,s=o()(e);!(a=(l=s.next()).done);a=!0){var u=l.value;if(u.id===t){this.leavemain.domains[i].auditGroupIDPath=u.parentIDPath?u.parentIDPath.concat():[],this.leavemain.domains[i].auditGroupIDPath.push(t);break}this.getGroupIDPath(u.children,t,i)}}catch(e){n=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw r}}}},handleLeaveSure:function(e){var t=this;if(e){var i=this.leavemain.domains,a=i.length;this.stationLeaveAuditFlowForm.requestRoleID=i[0].auditRoleID;for(var o=0;o<a;o++){var n=i[o].auditGroupIDPath.length;this.stationLeaveAuditFlowForm["auditGroupID"+(o+1)]=i[o].auditGroupIDPath[n-1],this.stationLeaveAuditFlowForm["auditRoleID"+(o+1)]=i[o].auditRoleID,this.stationLeaveAuditFlowForm["auditStaffLevelMaxDays"+(o+1)]=i[o].auditStaffLevelMaxDays}var r=this.stationLeaveAuditFlowForm;if(""===r.auditStaffLevelMaxDays1)return void this.$message({message:"天数不能为空",type:"error"});if(""===r.requestRoleID)return void this.$message({message:"发起申请选项不能为空",type:"error"});this.isLoading=!0,l.a.getConfigStaffLeaveAuditFlow(r).then(function(e){t.isstationLeaveAuditFlowForm=!1,t.isLoading=!1,t.getTree()},function(e){t.showErrorMessage(e.message),t.isLoading=!1})}else this.isstationLeaveAuditFlowForm=!1},addLeave:function(){this.leavemain.domains.length<4&&this.leavemain.domains.push({auditStaffLevelMaxDays:"",auditGroupID:"",auditRoleID:"",auditGroupIDPath:[],key:Date.now()})},removeLeave:function(e){var t=this.leavemain.domains.indexOf(e);-1!==t&&this.leavemain.domains.splice(t,1),this.resetLeaveAuditFlow(),this.stationLeaveAuditFlowForm.staffLeaveAuditFlowID=this.leaveActive.id},resetLeaveAuditFlow:function(){this.stationLeaveAuditFlowForm={auditStaffLevelMaxDays1:null,auditGroupID1:null,auditGroupID1Path:[],auditRoleID1:null,auditStaffLevelMaxDays2:null,auditGroupID2:null,auditGroupID2Path:[],auditRoleID2:null,auditStaffLevelMaxDays3:null,auditGroupID3:null,auditGroupID3Path:[],auditRoleID3:null,auditStaffLevelMaxDays4:null,auditGroupID4:null,auditGroupID4Path:[],auditRoleID4:null}},handChangeTree:function(e,t,i){null===e&&(e=this.leavemain.domains[i].auditGroupIDPath);for(var a=e.length-1,o=e[a],n=this.sourceList,l=0;l<n.length;l++)if(n[l].GroupID===o){if(null===t)if(null!==i){var s=this.limitRoleForm.length;i>s?this.limitRoleForm.push(n[l].Roles):this.limitRoleForm[i]=n[l].Roles}else this.limitRoleForm.push(n[l].Roles);else this.limitRoleForm.push(n[l].Roles);console.log("数据s"+r()(n[l].Roles))}},getGroupInfoBaseList:function(){var e=this;l.a.GetGroupInfoBaseList().then(function(t){e.sourceList=t.data.list,e.generateTree(),e.dataList=e.tree},function(e){console.log("errors"+r()(e))})},generateTree:function(){for(var e=this.sourceList[0].GroupID,t=1;t<this.sourceList.length;t++)if(this.sourceList[t].ParentID===e){var i={GroupID:this.sourceList[t].GroupID,Name:this.sourceList[t].Name,Roles:this.sourceList[t].Roles,Level:this.sourceList[t].Level};this.tree.push(i),this.addChildren(i,t)}},addChildren:function(e,t){for(var i=t+1;i<this.sourceList.length;i++)if(this.sourceList[i].ParentID===e.GroupID){var a={GroupID:this.sourceList[i].GroupID,Name:this.sourceList[i].Name,Roles:this.sourceList[i].Roles,Level:this.sourceList[i].Level};e.Children||(e.Children=[]),e.Children.push(a),this.addChildren(a,i)}},handleMove:function(e,t){var i=this;console.log("handleMove",e,t),this.validateBaseData()&&t&&(this.moveActive=t,this.generateParentTree(t),this.moveFormDialogVisible=!0,this.moveForm.sourceID=t.id,this.moveForm.targetIDPath=[],this.moveForm.movingLocation=0,this.moveForm.isChild=!1,this.$nextTick(function(){i.clearValidate("moveForm")}))},handleMoveFormSure:function(e){console.log("handleMoveFormSure",e),e?this.move():(this.moveFormDialogVisible=!1,this.moveActive=null)},add:function(){var e=this;this.$refs.mainForm.validate(function(t){if(!t)return!1;e.isLoading=!0,e.mainForm.parentID=e.mainForm.parentIDPath&&e.mainForm.parentIDPath.length?e.mainForm.parentIDPath[e.mainForm.parentIDPath.length-1]:null;var i=e.mainForm;l.a.addGroup(i).then(function(t){e.isLoading=!1,e.mainFormDialogVisible=!1,e.getTree()},function(t){e.isLoading=!1,e.showErrorMessage(t.message)})})},edit:function(){var e=this;if(!this.editActive)return void this.showErrorMessage("异常：无编辑目标");this.$refs.mainForm.validate(function(t){if(!t)return!1;e.isLoading=!0,e.mainForm.parentID=e.mainForm.parentIDPath&&e.mainForm.parentIDPath.length?e.mainForm.parentIDPath[e.mainForm.parentIDPath.length-1]:null;var i=e.mainForm;l.a.editGroup(i).then(function(t){e.isLoading=!1,e.editActive=null,e.mainFormDialogVisible=!1,e.getTree()},function(t){e.isLoading=!1,e.showErrorMessage(t.message)})})},remove:function(){var e=this;if(this.removeActive){var t={groupID:this.removeActive.id};this.isLoading=!0,l.a.removeGroup(t).then(function(t){e.isLoading=!1,e.removeActive=null,e.getTree()},function(t){e.isLoading=!1,e.showErrorMessage(t.message)})}},move:function(){var e=this;this.moveActive&&this.$refs.moveForm.validate(function(t){if(!t)return!1;var i={sourceID:e.moveActive.id,targetID:e.moveForm.targetIDPath[e.moveForm.targetIDPath.length-1],isChild:0===e.moveForm.movingLocation?e.moveForm.isChild:null,movingLocation:e.moveForm.movingLocation};console.log(e.moveForm),e.isLoading=!0,l.a.moveGroup(i).then(function(t){e.isLoading=!1,e.moveFormDialogVisible=!1,e.moveActive=null,e.getTree()},function(t){e.isLoading=!1,e.showErrorMessage(t.message)})})},validateBaseData:function(){return!!this.editRoleListData||(this.showErrorMessage("基础数据缺失：角色列表"),!1)},generateParentTree:function(e){if(!this.treeData)return void(this.editParentTreeData=[]);e?(this.editParentTreeData=u.a.cloneDeep(this.treeData),this.editParentTreeData=this.editParentTreeData.filter(function(e,t,i){return!e.isSystem}),this.filterTree(this.editParentTreeData,e)):this.editParentTreeData=this.treeData.filter(function(e,t,i){return!e.isSystem})},filterTree:function(e,t){for(var i=0;i<e.length;i++){var a=e[i];if(a.id===t.id){e.splice(i,1);break}a.children&&this.filterTree(a.children,t)}},resetForm:function(e){this.$refs[e].resetFields()},clearValidate:function(e){this.$refs[e].clearValidate()},showErrorMessage:function(e){this.$message({message:e,type:"error"})},renderContent:function(e,t){var i=this,a=t.node,o=t.data;t.store;return e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 10px;"},[e("span",null,[e("span",null,[a.label])]),e("span",null,[e("span",{style:"font-size: 12px;"},[" ",o.limitRoles?o.limitRoles.map(function(e){return e.name}).join(" "):""," "])]),e("span",{directives:[{name:"show",value:!o.isSystem}]},[e("span",{style:"font-size: 12px;",directives:[{name:"show",value:o.isDisabled}]},["[停用] "]),e("span",{style:"font-size: 12px;",directives:[{name:"show",value:o.isIncludeUser}]},["[用户] "]),e("el-button",{style:"font-size: 12px;",attrs:{type:"text",icon:"el-icon-edit-outline"},directives:[{name:"show",value:5===o.level}],on:{click:function(e){e.stopPropagation(),e.preventDefault(),i.handleLeave(a,o)}}},["请假流程"]),e("el-button",{style:"font-size: 12px;",attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),i.handleEdit(a,o)}}},["编辑"]),e("el-button",{style:"font-size: 12px;",attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),i.handleAdd(a,o)}}},["添加"]),e("el-button",{style:"font-size: 12px;",attrs:{type:"text",icon:"el-icon-rank"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),i.handleMove(a,o)}}},["移动"]),e("el-button",{style:"font-size: 12px;",attrs:{type:"text",icon:"el-icon-remove-outline"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),i.handleRemove(a,o)}}},["删除"])])])}}}},bzuE:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var a="/manager/api"},nbfF:function(e,t,i){"use strict";function a(e){i("2jAk")}var o=i("bdjN"),n=i("5/xs"),r=i("/Xao"),l=a,s=r(o.a,n.a,!1,l,"data-v-751b9a35",null);t.a=s.exports},uN2V:function(e,t){}},["8Som"]);
//# sourceMappingURL=department.js.map